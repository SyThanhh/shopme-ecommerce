package com.shopme;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.security.KeyStore;
import java.security.cert.CertificateFactory;
import java.security.cert.X509Certificate;

public class trustStoreUpdater {

	public static void main(String[] args) throws Exception {
        String trustStorePath = System.getProperty("java.home") + "/lib/security/cacerts";
        String certPath = "path/to/smtp_certificate.pem";
        String alias = "smtp-cert";

        // Load the default truststore
        KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
        try (FileInputStream trustStoreStream = new FileInputStream(trustStorePath)) {
            trustStore.load(trustStoreStream, "changeit".toCharArray()); // default password
        }

        // Load the certificate
        try (FileInputStream certStream = new FileInputStream(certPath)) {
            CertificateFactory certFactory = CertificateFactory.getInstance("X.509");
            X509Certificate certificate = (X509Certificate) certFactory.generateCertificate(certStream);
            trustStore.setCertificateEntry(alias, certificate);
        }

        // Save the updated truststore
        try (FileOutputStream trustStoreOut = new FileOutputStream(trustStorePath)) {
            trustStore.store(trustStoreOut, "changeit".toCharArray()); // default password
        }

        System.out.println("Certificate added successfully.");
    }

}
